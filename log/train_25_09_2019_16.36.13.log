2019-09-25 16:36:13,736 | TRAINER WARNING: Output directory C:\AML_seg_proj\CRC-Segmentation\model_affine\ already exists. Checkpoints might get overwritten.
2019-09-25 16:36:13,736 | TRAINER INFO: Epochs: 250 | Batch Size: 1 | Processed images per epoch: 300 | #Processes for Dataloading: 2
2019-09-25 16:36:13,900 | TRAINER INFO: Using GPU "GeForce GTX 1060 6GB" for training.
2019-09-25 16:36:13,900 | TRAINER INFO: Total available training instances: 9928
2019-09-25 16:36:13,900 | TRAINER INFO: Using 5-Fold Cross Validation.
2019-09-25 16:36:16,931 | TRAINER INFO: Restored model and optimizer settings.
2019-09-25 16:36:16,932 | TRAINER INFO: Resuming training from following checkpoints: ['C:\\AML_seg_proj\\CRC-Segmentation\\model_affine\\model_chkpt_55.pt', 'C:\\AML_seg_proj\\CRC-Segmentation\\model_affine\\optimizer_chkpt_55.pt']
2019-09-25 16:36:16,932 | TRAINER INFO: Model: NeuralNet(
  (dropout): Dropout(p=0.33, inplace=True)
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (convin1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv12): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv23): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv34): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv45): Conv2d(512, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv54): Conv2d(1024, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv43): Conv2d(512, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv32): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv21): Conv2d(128, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv1out): Conv2d(64, 3, kernel_size=(1, 1), stride=(1, 1))
  (conv11): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv22): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv33): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv44): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv55): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (upconv1): ConvTranspose2d(1024, 512, kernel_size=(2, 2), stride=(2, 2))
  (upconv2): ConvTranspose2d(512, 256, kernel_size=(2, 2), stride=(2, 2))
  (upconv3): ConvTranspose2d(256, 128, kernel_size=(2, 2), stride=(2, 2))
  (upconv4): ConvTranspose2d(128, 64, kernel_size=(2, 2), stride=(2, 2))
  (inst_norm1): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm2): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm3): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm4): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm5): InstanceNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_normout): InstanceNorm2d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (activation): LeakyReLU(negative_slope=0.01, inplace=True)
)
2019-09-25 16:36:16,933 | TRAINER INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0005
    weight_decay: 3e-05
)
2019-09-25 16:36:16,934 | TRAINER INFO: Loss Function: Dice_and_CE(
  (dice): Dice_Loss()
  (ce): CrossEntropyLoss()
)
2019-09-25 16:36:16,934 | TRAINER INFO: Training EPOCH: 56
2019-09-25 16:44:40,143 | TRAINER INFO: avg. CV tr. losses: [0.2262594514215986, 0.2240808612977465, 0.22251633343597252, 0.2243487598374486, 0.2225437439357241]
2019-09-25 16:44:40,143 | TRAINER INFO: avg. CV val. losses: [0.4216204447050889, 0.31206585466861725, 0.41972023000319797, 0.26243093808492024, 0.2788011744618416]
2019-09-25 16:44:40,143 | TRAINER INFO: Epoch: 56 took 503.20733570000004s | cv iter tr_loss 0.2243487598374486 | cv iter val_loss: 0.26243093808492024
2019-09-25 16:44:40,143 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.2243487598374486, val_MA 0.26243093808492024
2019-09-25 16:44:40,144 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 16:44:40,871 | TRAINER INFO: Training EPOCH: 57
2019-09-25 16:52:56,154 | TRAINER INFO: avg. CV tr. losses: [0.17841463548441727, 0.212570444184045, 0.2128153489281734, 0.2138439149906238, 0.21207966897636651]
2019-09-25 16:52:56,154 | TRAINER INFO: avg. CV val. losses: [0.3345000339051088, 0.025157582263151804, 0.3067627524336179, 0.2984516059358915, 0.3119480793674787]
2019-09-25 16:52:56,155 | TRAINER INFO: Epoch: 57 took 495.28206869999997s | cv iter tr_loss 0.212570444184045 | cv iter val_loss: 0.025157582263151804
2019-09-25 16:52:56,155 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.22317092827210822, val_MA 0.2387036025027434
2019-09-25 16:52:56,155 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 16:52:57,087 | TRAINER INFO: Training EPOCH: 58
2019-09-25 17:01:12,612 | TRAINER INFO: avg. CV tr. losses: [0.17922264815618594, 0.22177560410151878, 0.21810542351255816, 0.2199869455769658, 0.2187814007823666]
2019-09-25 17:01:12,613 | TRAINER INFO: avg. CV val. losses: [0.2887374113003413, 0.17261213809251785, 0.20321951856215795, 0.20597871293624243, 0.1538305714726448]
2019-09-25 17:01:12,614 | TRAINER INFO: Epoch: 58 took 495.52479600000004s | cv iter tr_loss 0.2187814007823666 | cv iter val_loss: 0.1538305714726448
2019-09-25 17:01:12,615 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.22273197552313406, val_MA 0.23021629939973354
2019-09-25 17:01:12,615 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 17:01:13,301 | TRAINER INFO: Training EPOCH: 59
2019-09-25 17:09:28,641 | TRAINER INFO: avg. CV tr. losses: [0.22321547213941811, 0.18484711262087028, 0.18657601202527682, 0.18360531603296598, 0.18596811387687923]
2019-09-25 17:09:28,641 | TRAINER INFO: avg. CV val. losses: [0.16044287631909052, 0.1888710285226504, 0.18858247101306916, -0.025007066130638123, 0.15717120096087456]
2019-09-25 17:09:28,643 | TRAINER INFO: Epoch: 59 took 495.3398188000001s | cv iter tr_loss 0.18360531603296598 | cv iter val_loss: -0.025007066130638123
2019-09-25 17:09:28,644 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.21881930957411724, val_MA 0.2046939628466964
2019-09-25 17:09:28,644 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 17:09:29,346 | TRAINER INFO: Training EPOCH: 60
2019-09-25 17:17:44,731 | TRAINER INFO: avg. CV tr. losses: [0.1740617288276553, 0.17894640360027553, 0.1785546248157819, 0.17734811392923197, 0.1768467436855038]
2019-09-25 17:17:44,731 | TRAINER INFO: avg. CV val. losses: [0.15410514920949936, 0.26649509196480115, 0.16068734874327978, 0.22322876999775568, 0.19520195176204044]
2019-09-25 17:17:44,733 | TRAINER INFO: Epoch: 60 took 495.38421129999983s | cv iter tr_loss 0.1740617288276553 | cv iter val_loss: 0.15410514920949936
2019-09-25 17:17:44,734 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.21434355149947104, val_MA 0.1996350814829767
2019-09-25 17:17:44,734 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 17:17:44,736 | TRAINER INFO: Saving Progress to C:\AML_seg_proj\CRC-Segmentation\model_affine\
2019-09-25 17:17:45,435 | TRAINER INFO: Training EPOCH: 61
2019-09-25 17:26:19,025 | TRAINER INFO: avg. CV tr. losses: [0.24662407524883748, 0.14417245003084342, 0.1420907709126671, 0.14593462366610765, 0.14517989462862413]
2019-09-25 17:26:19,025 | TRAINER INFO: avg. CV val. losses: [0.120700437327226, 0.30760358075300853, 0.26643538822730384, 0.2225853130221367, 0.2637587862710158]
2019-09-25 17:26:19,027 | TRAINER INFO: Epoch: 61 took 513.5889125000003s | cv iter tr_loss 0.24662407524883748 | cv iter val_loss: 0.120700437327226
2019-09-25 17:26:19,028 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.2175716038744077, val_MA 0.19174161706740164
2019-09-25 17:26:19,028 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 17:26:19,719 | TRAINER INFO: Training EPOCH: 62
2019-09-25 17:34:56,164 | TRAINER INFO: avg. CV tr. losses: [0.15896630696952344, 0.23799734363953273, 0.23705562707036734, 0.23344110983113447, 0.23448533639311792]
2019-09-25 17:34:56,165 | TRAINER INFO: avg. CV val. losses: [0.2033959746360779, 0.2757100333770116, 0.20131280720233918, 0.052650994062423705, 0.19165212710698445]
2019-09-25 17:34:56,167 | TRAINER INFO: Epoch: 62 took 516.4439480000001s | cv iter tr_loss 0.23344110983113447 | cv iter val_loss: 0.052650994062423705
2019-09-25 17:34:56,167 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.21915855447008037, val_MA 0.17783255476690385
2019-09-25 17:34:56,168 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 17:34:56,863 | TRAINER INFO: Training EPOCH: 63
2019-09-25 17:43:33,344 | TRAINER INFO: avg. CV tr. losses: [0.21207480014612276, 0.2705476310104132, 0.26237890279541415, 0.26274190365026395, 0.2617943517242869]
2019-09-25 17:43:33,344 | TRAINER INFO: avg. CV val. losses: [0.2327265575528145, 0.16508198281129202, 0.45760248452425, 0.25611690084139505, 0.1118608941634496]
2019-09-25 17:43:33,346 | TRAINER INFO: Epoch: 63 took 516.4796326000001s | cv iter tr_loss 0.2617943517242869 | cv iter val_loss: 0.1118608941634496
2019-09-25 17:43:33,346 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.22342213419550103, val_MA 0.17123538870655844
2019-09-25 17:43:33,347 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 17:43:34,031 | TRAINER INFO: Training EPOCH: 64
2019-09-25 17:52:10,487 | TRAINER INFO: avg. CV tr. losses: [0.2154737037916978, 0.201572955523928, 0.1906809516871969, 0.19127225782722235, 0.19426133719583352]
2019-09-25 17:52:10,488 | TRAINER INFO: avg. CV val. losses: [0.20020411610603334, 0.127567362288634, 0.2166095698873202, 0.28758983438213664, 0.20238959764440853]
2019-09-25 17:52:10,490 | TRAINER INFO: Epoch: 64 took 516.4558742999998s | cv iter tr_loss 0.201572955523928 | cv iter val_loss: 0.127567362288634
2019-09-25 17:52:10,490 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.22123721632834373, val_MA 0.16686858606476598
2019-09-25 17:52:10,491 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 17:52:11,235 | TRAINER INFO: Training EPOCH: 65
2019-09-25 18:00:48,194 | TRAINER INFO: avg. CV tr. losses: [0.13998461198061704, 0.17161289217571418, 0.17135243744899828, 0.16916738239427406, 0.17076276522129774]
2019-09-25 18:00:48,195 | TRAINER INFO: avg. CV val. losses: [0.18514526436726253, 0.24670402059952418, 0.20472728808720905, 0.09800948897997538, 0.18832266678412754]
2019-09-25 18:00:48,197 | TRAINER INFO: Epoch: 65 took 516.9586125000005s | cv iter tr_loss 0.16916738239427406 | cv iter val_loss: 0.09800948897997538
2019-09-25 18:00:48,197 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.21603023293493676, val_MA 0.15998267635628693
2019-09-25 18:00:48,198 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 18:00:48,199 | TRAINER INFO: Saving Progress to C:\AML_seg_proj\CRC-Segmentation\model_affine\
2019-09-25 18:00:48,921 | TRAINER INFO: Training EPOCH: 66
2019-09-25 18:09:25,550 | TRAINER INFO: avg. CV tr. losses: [0.19448108617216348, 0.1735801503062248, 0.17252814347545306, 0.17530171163380145, 0.17324707998583713]
2019-09-25 18:09:25,551 | TRAINER INFO: avg. CV val. losses: [0.144709063321352, 0.12593974843621253, 0.35626501962542534, 0.3273943819105625, 0.3247829392552376]
2019-09-25 18:09:25,552 | TRAINER INFO: Epoch: 66 took 516.6288003s | cv iter tr_loss 0.1735801503062248 | cv iter val_loss: 0.12593974843621253
2019-09-25 18:09:25,553 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.21178522467206556, val_MA 0.1565783835642795
2019-09-25 18:09:25,553 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 18:09:26,293 | TRAINER INFO: Training EPOCH: 67
2019-09-25 18:18:02,787 | TRAINER INFO: avg. CV tr. losses: [0.1944276699796319, 0.1646151527762413, 0.16783534431209166, 0.16702336377153795, 0.16471888702362775]
2019-09-25 18:18:02,787 | TRAINER INFO: avg. CV val. losses: [0.11865184009075165, 0.15775402535994848, 0.036110231280326845, 0.15530312210321426, 0.22657333066066107]
2019-09-25 18:18:02,789 | TRAINER INFO: Epoch: 67 took 516.4947302s | cv iter tr_loss 0.16783534431209166 | cv iter val_loss: 0.036110231280326845
2019-09-25 18:18:02,790 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.20739023663606818, val_MA 0.14453156833588424
2019-09-25 18:18:02,791 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 18:18:03,480 | TRAINER INFO: Training EPOCH: 68
2019-09-25 18:26:39,897 | TRAINER INFO: avg. CV tr. losses: [0.2169912903259198, 0.19040716557453077, 0.18772300959875185, 0.18575686309486628, 0.18768787508209547]
2019-09-25 18:26:39,897 | TRAINER INFO: avg. CV val. losses: [0.4073332985242208, 0.3575511296590169, 0.10709572856624922, 0.1526572731633981, 0.24338694413503012]
2019-09-25 18:26:39,899 | TRAINER INFO: Epoch: 68 took 516.4177547999998s | cv iter tr_loss 0.18772300959875185 | cv iter val_loss: 0.10709572856624922
2019-09-25 18:26:39,900 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.20542351393233654, val_MA 0.14078798435892073
2019-09-25 18:26:39,900 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 18:26:40,796 | TRAINER INFO: Training EPOCH: 69
2019-09-25 18:35:17,123 | TRAINER INFO: avg. CV tr. losses: [0.2101585094506542, 0.1748193840806683, 0.17300550621002914, 0.1827568310002486, 0.18328318887700637]
2019-09-25 18:35:17,123 | TRAINER INFO: avg. CV val. losses: [0.1658583184083303, 0.3536823106308778, 0.02607206553220749, 0.09903023838996887, 0.08577265342076619]
2019-09-25 18:35:17,125 | TRAINER INFO: Epoch: 69 took 516.3251598999996s | cv iter tr_loss 0.17300550621002914 | cv iter val_loss: 0.02607206553220749
2019-09-25 18:35:17,126 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.2021817131601058, val_MA 0.1293163924762494
2019-09-25 18:35:17,126 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 18:35:17,819 | TRAINER INFO: Training EPOCH: 70
2019-09-25 18:43:54,305 | TRAINER INFO: avg. CV tr. losses: [0.21131793241947888, 0.1671236462891102, 0.1691283733273546, 0.16521643834809463, 0.1676480328043302]
2019-09-25 18:43:54,306 | TRAINER INFO: avg. CV val. losses: [0.18541276181737582, 0.09740768522024154, 0.04104703838626544, 0.23529652853806812, 0.2607016126314799]
2019-09-25 18:43:54,308 | TRAINER INFO: Epoch: 70 took 516.4858141999994s | cv iter tr_loss 0.1691283733273546 | cv iter val_loss: 0.04104703838626544
2019-09-25 18:43:54,308 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.19887637917683068, val_MA 0.120489457067251
2019-09-25 18:43:54,309 | TRAINER INFO: Current Learning Rate: 0.0005
2019-09-25 18:43:54,310 | TRAINER INFO: Saving Progress to C:\AML_seg_proj\CRC-Segmentation\model_affine\
2019-09-25 18:43:55,034 | TRAINER INFO: Training EPOCH: 71
