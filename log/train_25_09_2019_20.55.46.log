2019-09-25 20:55:46,997 | TRAINER WARNING: Output directory C:\AML_seg_proj\CRC-Segmentation\model_affine\ already exists. Checkpoints might get overwritten.
2019-09-25 20:55:46,998 | TRAINER INFO: Epochs: 250 | Batch Size: 1 | Processed images per epoch: 300 | #Processes for Dataloading: 2
2019-09-25 20:55:47,167 | TRAINER INFO: Using GPU "GeForce GTX 1060 6GB" for training.
2019-09-25 20:55:47,167 | TRAINER INFO: Total available training instances: 9928
2019-09-25 20:55:47,168 | TRAINER INFO: Using 5-Fold Cross Validation.
2019-09-25 20:55:50,971 | TRAINER INFO: Restored model and optimizer settings.
2019-09-25 20:55:50,972 | TRAINER INFO: Resuming training from following checkpoints: ['C:\\AML_seg_proj\\CRC-Segmentation\\model_affine\\model_chkpt_75.pt', 'C:\\AML_seg_proj\\CRC-Segmentation\\model_affine\\optimizer_chkpt_75.pt']
2019-09-25 20:55:50,972 | TRAINER INFO: Model: NeuralNet(
  (dropout): Dropout(p=0.33, inplace=True)
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (convin1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv12): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv23): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv34): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv45): Conv2d(512, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv54): Conv2d(1024, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv43): Conv2d(512, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv32): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv21): Conv2d(128, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv1out): Conv2d(64, 3, kernel_size=(1, 1), stride=(1, 1))
  (conv11): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv22): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv33): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv44): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv55): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (upconv1): ConvTranspose2d(1024, 512, kernel_size=(2, 2), stride=(2, 2))
  (upconv2): ConvTranspose2d(512, 256, kernel_size=(2, 2), stride=(2, 2))
  (upconv3): ConvTranspose2d(256, 128, kernel_size=(2, 2), stride=(2, 2))
  (upconv4): ConvTranspose2d(128, 64, kernel_size=(2, 2), stride=(2, 2))
  (inst_norm1): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm2): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm3): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm4): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm5): InstanceNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_normout): InstanceNorm2d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (activation): LeakyReLU(negative_slope=0.01, inplace=True)
)
2019-09-25 20:55:50,973 | TRAINER INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.00025
    weight_decay: 3e-05
)
2019-09-25 20:55:50,974 | TRAINER INFO: Loss Function: Dice_and_CE(
  (dice): Dice_Loss()
  (ce): CrossEntropyLoss()
)
2019-09-25 20:55:50,974 | TRAINER INFO: Training EPOCH: 76
2019-09-25 21:04:34,963 | TRAINER INFO: avg. CV tr. losses: [0.17989501903454463, 0.17714837832997243, 0.17844110050549108, 0.18082906429966292, 0.1782341620574395]
2019-09-25 21:04:34,963 | TRAINER INFO: avg. CV val. losses: [0.20083839545647303, 0.3004554194708665, 0.1268938273191452, 0.31228405982255936, 0.09121417452891668]
2019-09-25 21:04:34,963 | TRAINER INFO: Epoch: 76 took 523.9877829000001s | cv iter tr_loss 0.1782341620574395 | cv iter val_loss: 0.09121417452891668
2019-09-25 21:04:34,964 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.1782341620574395, val_MA 0.09121417452891668
2019-09-25 21:04:34,964 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 21:04:35,686 | TRAINER INFO: Training EPOCH: 77
2019-09-25 21:13:12,873 | TRAINER INFO: avg. CV tr. losses: [0.18217681298653285, 0.19242497961968183, 0.19359061680734158, 0.19359897511700788, 0.1931248938043912]
2019-09-25 21:13:12,873 | TRAINER INFO: avg. CV val. losses: [0.2485424945751826, 0.13372264057397842, 0.15449223270018894, 0.04218088785807292, 0.16386097421248755]
2019-09-25 21:13:12,874 | TRAINER INFO: Epoch: 77 took 517.1858682s | cv iter tr_loss 0.19359897511700788 | cv iter val_loss: 0.04218088785807292
2019-09-25 21:13:12,874 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.17977064336339632, val_MA 0.08631084586183231
2019-09-25 21:13:12,874 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 21:13:13,549 | TRAINER INFO: Training EPOCH: 78
2019-09-25 21:21:50,254 | TRAINER INFO: avg. CV tr. losses: [0.11055650077760219, 0.18128778512279192, 0.180855245826145, 0.1832651438812415, 0.18413291623195013]
2019-09-25 21:21:50,254 | TRAINER INFO: avg. CV val. losses: [0.15262248863776526, 0.07397460540135702, 0.12714977463086446, 0.10119365702072779, 0.15845397710800171]
2019-09-25 21:21:50,254 | TRAINER INFO: Epoch: 78 took 516.7049267999998s | cv iter tr_loss 0.18128778512279192 | cv iter val_loss: 0.07397460540135702
2019-09-25 21:21:50,255 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.1799223575393359, val_MA 0.08507722181578478
2019-09-25 21:21:50,255 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 21:21:51,050 | TRAINER INFO: Training EPOCH: 79
2019-09-25 21:30:09,779 | TRAINER INFO: avg. CV tr. losses: [0.14906881079077722, 0.19248862713575363, 0.1967400062829256, 0.1944807689016064, 0.19373206732173762]
2019-09-25 21:30:09,779 | TRAINER INFO: avg. CV val. losses: [0.23281209270159403, 0.134165175507466, 0.2506321271260579, 0.11872710610429446, 0.03869871770342191]
2019-09-25 21:30:09,779 | TRAINER INFO: Epoch: 79 took 498.72769300000004s | cv iter tr_loss 0.19373206732173762 | cv iter val_loss: 0.03869871770342191
2019-09-25 21:30:09,780 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.18130332851757608, val_MA 0.0804393714045485
2019-09-25 21:30:09,780 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 21:30:10,462 | TRAINER INFO: Training EPOCH: 80
2019-09-25 21:38:46,134 | TRAINER INFO: avg. CV tr. losses: [0.1709779292345047, 0.15814520778755348, 0.16312746138622364, 0.16366383669277032, 0.16035878428568442]
2019-09-25 21:38:46,135 | TRAINER INFO: avg. CV val. losses: [0.18865509579579035, 0.16869696949919064, 0.06461948255697886, 0.1455670247475306, 0.17585746869444846]
2019-09-25 21:38:46,135 | TRAINER INFO: Epoch: 80 took 515.6722310999999s | cv iter tr_loss 0.16312746138622364 | cv iter val_loss: 0.06461948255697886
2019-09-25 21:38:46,135 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.17948574180444082, val_MA 0.07885738251979155
2019-09-25 21:38:46,136 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 21:38:46,137 | TRAINER INFO: Saving Progress to C:\AML_seg_proj\CRC-Segmentation\model_affine\
2019-09-25 21:38:46,867 | TRAINER INFO: Training EPOCH: 81
2019-09-25 21:47:22,849 | TRAINER INFO: avg. CV tr. losses: [0.17548849241187175, 0.17823653779923915, 0.17693089389552671, 0.17718813357253868, 0.1772744274387757]
2019-09-25 21:47:22,850 | TRAINER INFO: avg. CV val. losses: [0.2768071055412292, 0.23220801924665768, 0.11004727880160013, 0.06941891213258107, 0.30299936383962633]
2019-09-25 21:47:22,850 | TRAINER INFO: Epoch: 81 took 515.9823630000001s | cv iter tr_loss 0.17718813357253868 | cv iter val_loss: 0.06941891213258107
2019-09-25 21:47:22,850 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.17925598098125062, val_MA 0.07791353548107051
2019-09-25 21:47:22,850 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 21:47:23,578 | TRAINER INFO: Training EPOCH: 82
2019-09-25 21:55:54,688 | TRAINER INFO: avg. CV tr. losses: [0.20343728562196095, 0.13854600402216116, 0.13946596756577492, 0.13969085446248453, 0.140240440890193]
2019-09-25 21:55:54,689 | TRAINER INFO: avg. CV val. losses: [0.05000955859820048, 0.13734313622117042, 0.23206670333941778, 0.16362298081318538, 0.34437309900919594]
2019-09-25 21:55:54,691 | TRAINER INFO: Epoch: 82 took 511.11027620000004s | cv iter tr_loss 0.20343728562196095 | cv iter val_loss: 0.05000955859820048
2019-09-25 21:55:54,692 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.18167411144532167, val_MA 0.07512313779278351
2019-09-25 21:55:54,692 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 21:55:55,404 | TRAINER INFO: Training EPOCH: 83
2019-09-25 22:04:30,444 | TRAINER INFO: avg. CV tr. losses: [0.11918944101780653, 0.14025672587255636, 0.13977597896009683, 0.14232920594513415, 0.13845529773583015]
2019-09-25 22:04:30,444 | TRAINER INFO: avg. CV val. losses: [0.009891187647978465, 0.06165187880396843, 0.16613745192686716, 0.15579867859681448, 0.1901078018049399]
2019-09-25 22:04:30,444 | TRAINER INFO: Epoch: 83 took 515.0386199s | cv iter tr_loss 0.11918944101780653 | cv iter val_loss: 0.009891187647978465
2019-09-25 22:04:30,445 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.17542564440257016, val_MA 0.06859994277830302
2019-09-25 22:04:30,445 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 22:04:31,245 | TRAINER INFO: Training EPOCH: 84
2019-09-25 22:13:06,017 | TRAINER INFO: avg. CV tr. losses: [0.1766952242081364, 0.22566304728388786, 0.2290465480958422, 0.22884857741494974, 0.22309943102300167]
2019-09-25 22:13:06,017 | TRAINER INFO: avg. CV val. losses: [0.2915532986323039, 0.2311584894855817, 0.11381932497024536, 0.20978008980552357, 0.09061724940935771]
2019-09-25 22:13:06,018 | TRAINER INFO: Epoch: 84 took 514.7725420000006s | cv iter tr_loss 0.22309943102300167 | cv iter val_loss: 0.09061724940935771
2019-09-25 22:13:06,018 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.18019302306461332, val_MA 0.07080167344140849
2019-09-25 22:13:06,018 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 22:13:06,713 | TRAINER INFO: Training EPOCH: 85
2019-09-25 22:21:41,290 | TRAINER INFO: avg. CV tr. losses: [0.14123018607497215, 0.16365684146682422, 0.16681400897602242, 0.17175141256302595, 0.1667707181846102]
2019-09-25 22:21:41,290 | TRAINER INFO: avg. CV val. losses: [0.18901742175221442, 0.17248863329490025, 0.15741658558448154, 0.23305468509594598, 0.13494750609000525]
2019-09-25 22:21:41,292 | TRAINER INFO: Epoch: 85 took 514.5763141999996s | cv iter tr_loss 0.1667707181846102 | cv iter val_loss: 0.13494750609000525
2019-09-25 22:21:41,292 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.17885079257661302, val_MA 0.07721625670626815
2019-09-25 22:21:41,293 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 22:21:41,295 | TRAINER INFO: Saving Progress to C:\AML_seg_proj\CRC-Segmentation\model_affine\
2019-09-25 22:21:42,049 | TRAINER INFO: Training EPOCH: 86
