2019-09-25 19:38:26,575 | TRAINER WARNING: Output directory C:\AML_seg_proj\CRC-Segmentation\model_affine\ already exists. Checkpoints might get overwritten.
2019-09-25 19:38:26,576 | TRAINER INFO: Epochs: 250 | Batch Size: 1 | Processed images per epoch: 300 | #Processes for Dataloading: 2
2019-09-25 19:38:26,746 | TRAINER INFO: Using GPU "GeForce GTX 1060 6GB" for training.
2019-09-25 19:38:26,747 | TRAINER INFO: Total available training instances: 9928
2019-09-25 19:38:26,747 | TRAINER INFO: Using 5-Fold Cross Validation.
2019-09-25 19:38:29,779 | TRAINER INFO: Restored model and optimizer settings.
2019-09-25 19:38:29,781 | TRAINER INFO: Resuming training from following checkpoints: ['C:\\AML_seg_proj\\CRC-Segmentation\\model_affine\\model_chkpt_75.pt', 'C:\\AML_seg_proj\\CRC-Segmentation\\model_affine\\optimizer_chkpt_75.pt']
2019-09-25 19:38:29,782 | TRAINER INFO: Model: NeuralNet(
  (dropout): Dropout(p=0.33, inplace=True)
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (convin1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv12): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv23): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv34): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv45): Conv2d(512, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv54): Conv2d(1024, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv43): Conv2d(512, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv32): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv21): Conv2d(128, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv1out): Conv2d(64, 3, kernel_size=(1, 1), stride=(1, 1))
  (conv11): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv22): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv33): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv44): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (conv55): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (upconv1): ConvTranspose2d(1024, 512, kernel_size=(2, 2), stride=(2, 2))
  (upconv2): ConvTranspose2d(512, 256, kernel_size=(2, 2), stride=(2, 2))
  (upconv3): ConvTranspose2d(256, 128, kernel_size=(2, 2), stride=(2, 2))
  (upconv4): ConvTranspose2d(128, 64, kernel_size=(2, 2), stride=(2, 2))
  (inst_norm1): InstanceNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm2): InstanceNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm3): InstanceNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm4): InstanceNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_norm5): InstanceNorm2d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (inst_normout): InstanceNorm2d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
  (activation): LeakyReLU(negative_slope=0.01, inplace=True)
)
2019-09-25 19:38:29,782 | TRAINER INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.00025
    weight_decay: 3e-05
)
2019-09-25 19:38:29,783 | TRAINER INFO: Loss Function: Dice_and_CE(
  (dice): Dice_Loss()
  (ce): CrossEntropyLoss()
)
2019-09-25 19:38:29,783 | TRAINER INFO: Training EPOCH: 76
2019-09-25 19:46:55,048 | TRAINER INFO: avg. CV tr. losses: [0.20392597708851098, 0.13595640106747547, 0.13428211019684871, 0.13664691957334676, 0.1360998736694455]
2019-09-25 19:46:55,048 | TRAINER INFO: avg. CV val. losses: [0.18750049273173014, 0.22455447415510812, 0.19592795222997667, 0.1586440272629261, 0.16934800545374554]
2019-09-25 19:46:55,049 | TRAINER INFO: Epoch: 76 took 505.2647521s | cv iter tr_loss 0.13664691957334676 | cv iter val_loss: 0.1586440272629261
2019-09-25 19:46:55,049 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.13664691957334676, val_MA 0.1586440272629261
2019-09-25 19:46:55,049 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 19:46:55,906 | TRAINER INFO: Training EPOCH: 77
2019-09-25 19:55:13,659 | TRAINER INFO: avg. CV tr. losses: [0.19403304836402338, 0.15409762393683196, 0.1549279972910881, 0.15280437966187796, 0.1550526560594638]
2019-09-25 19:55:13,659 | TRAINER INFO: avg. CV val. losses: [0.08994264205296834, 0.3260557139913241, 0.14442885120709736, 0.24751375317573548, 0.23469774425029755]
2019-09-25 19:55:13,661 | TRAINER INFO: Epoch: 77 took 497.7529458s | cv iter tr_loss 0.19403304836402338 | cv iter val_loss: 0.08994264205296834
2019-09-25 19:55:13,662 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.14238553245241442, val_MA 0.15177388874193032
2019-09-25 19:55:13,662 | TRAINER INFO: Current Learning Rate: 0.00025
2019-09-25 19:55:14,344 | TRAINER INFO: Training EPOCH: 78
2019-09-25 20:03:32,423 | TRAINER INFO: avg. CV tr. losses: [0.18341627375533184, 0.16579214309652646, 0.16895107682794333, 0.16490962474296492, 0.16621099517991145]
2019-09-25 20:03:32,423 | TRAINER INFO: avg. CV val. losses: [0.20268968492746353, 0.22807660301526386, 0.19043387075265247, 0.031275550524393715, 0.14446743428707123]
2019-09-25 20:03:32,424 | TRAINER INFO: Epoch: 78 took 498.07884390000015s | cv iter tr_loss 0.16490962474296492 | cv iter val_loss: 0.031275550524393715
2019-09-25 20:03:32,425 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.14463794168146948, val_MA 0.13972405492017664
2019-09-25 20:03:32,425 | TRAINER INFO: Current Learning Rate: 0.000125
2019-09-25 20:03:33,117 | TRAINER INFO: Training EPOCH: 79
2019-09-25 20:11:51,181 | TRAINER INFO: avg. CV tr. losses: [0.17351866848766803, 0.13346139167745907, 0.13470090714593727, 0.13403377123177052, 0.13393808733671903]
2019-09-25 20:11:51,181 | TRAINER INFO: avg. CV val. losses: [0.23685985058546066, 0.15160540988047919, 0.16338913540045422, 0.25154936959346136, 0.12812404856085777]
2019-09-25 20:11:51,183 | TRAINER INFO: Epoch: 79 took 498.0643247999999s | cv iter tr_loss 0.13393808733671903 | cv iter val_loss: 0.12812404856085777
2019-09-25 20:11:51,184 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.14356795624699445, val_MA 0.13856405428424476
2019-09-25 20:11:51,184 | TRAINER INFO: Current Learning Rate: 0.000125
2019-09-25 20:11:51,894 | TRAINER INFO: Training EPOCH: 80
2019-09-25 20:20:09,714 | TRAINER INFO: avg. CV tr. losses: [0.12367003212372461, 0.1396207008510828, 0.14074696184446414, 0.13994850168625514, 0.1381186770275235]
2019-09-25 20:20:09,715 | TRAINER INFO: avg. CV val. losses: [0.1052450604736805, 0.13829351738095283, 0.14736311187346776, 0.1565148333708445, 0.3868922534088294]
2019-09-25 20:20:09,716 | TRAINER INFO: Epoch: 80 took 497.8197224000003s | cv iter tr_loss 0.12367003212372461 | cv iter val_loss: 0.1052450604736805
2019-09-25 20:20:09,716 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.14157816383466748, val_MA 0.13523215490318832
2019-09-25 20:20:09,717 | TRAINER INFO: Current Learning Rate: 6.25e-05
2019-09-25 20:20:09,718 | TRAINER INFO: Saving Progress to C:\AML_seg_proj\CRC-Segmentation\model_affine\
2019-09-25 20:20:10,418 | TRAINER INFO: Training EPOCH: 81
2019-09-25 20:28:28,362 | TRAINER INFO: avg. CV tr. losses: [0.18017494728167852, 0.11948595102876425, 0.11983144438515107, 0.12036961875855923, 0.1206629753112793]
2019-09-25 20:28:28,362 | TRAINER INFO: avg. CV val. losses: [0.17973845899105073, 0.1443695495525996, 0.19302890151739122, 0.10101970682541529, 0.27279476697246235]
2019-09-25 20:28:28,364 | TRAINER INFO: Epoch: 81 took 497.94299930000034s | cv iter tr_loss 0.12036961875855923 | cv iter val_loss: 0.10101970682541529
2019-09-25 20:28:28,364 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.13945730932705666, val_MA 0.13181091009541102
2019-09-25 20:28:28,365 | TRAINER INFO: Current Learning Rate: 6.25e-05
2019-09-25 20:28:29,131 | TRAINER INFO: Training EPOCH: 82
2019-09-25 20:36:47,141 | TRAINER INFO: avg. CV tr. losses: [0.1365662954126795, 0.14013191126286983, 0.13940962279836336, 0.13987844890604417, 0.139424706188341]
2019-09-25 20:36:47,141 | TRAINER INFO: avg. CV val. losses: [0.20258274525403977, 0.2321930189927419, 0.03696695218483607, 0.14201941316326458, 0.2849896753827731]
2019-09-25 20:36:47,142 | TRAINER INFO: Epoch: 82 took 498.00854260000006s | cv iter tr_loss 0.13940962279836336 | cv iter val_loss: 0.03696695218483607
2019-09-25 20:36:47,143 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.13945254067418733, val_MA 0.12232651430435353
2019-09-25 20:36:47,143 | TRAINER INFO: Current Learning Rate: 3.125e-05
2019-09-25 20:36:47,841 | TRAINER INFO: Training EPOCH: 83
2019-09-25 20:45:05,564 | TRAINER INFO: avg. CV tr. losses: [0.14568734398732583, 0.1522370897854368, 0.15213380400091409, 0.15195083140085142, 0.1528007848188281]
2019-09-25 20:45:05,564 | TRAINER INFO: avg. CV val. losses: [0.23797726680835088, 0.20709398289521536, 0.031954685350259145, 0.18328720604379972, 0.3437799960374832]
2019-09-25 20:45:05,566 | TRAINER INFO: Epoch: 83 took 497.7232386999999s | cv iter tr_loss 0.15213380400091409 | cv iter val_loss: 0.031954685350259145
2019-09-25 20:45:05,567 | TRAINER INFO: Exponential Moving Averages: tr_MA 0.14072066700686, val_MA 0.1132893314089441
2019-09-25 20:45:05,568 | TRAINER INFO: Current Learning Rate: 3.125e-05
2019-09-25 20:45:06,288 | TRAINER INFO: Training EPOCH: 84
